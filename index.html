<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Border Calculator</title>
  <style>
    :root{
      --bg:#0f1115;
      --card:#151822;
      --text:#e8eef6;
      --muted:#a7b0be;
      --line:rgba(255,255,255,.10);
      --accent:#6ea8fe;
      --warn:#fbbf24;
      --radius:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:var(--bg);
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:22px;
    }
    .wrap{width:min(940px, 100%); display:grid; gap:14px;}
    header{
      display:flex; justify-content:space-between; align-items:flex-end; gap:12px; flex-wrap:wrap;
    }
    h1{margin:0; font-size:20px; letter-spacing:.2px;}
    .sub{margin:6px 0 0 0; color:var(--muted); font-size:13px; line-height:1.4;}
    .pills{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px; border:1px solid var(--line); border-radius:999px;
      color:var(--muted); font-size:12px;
      background:rgba(255,255,255,.02);
    }
    .pill b{color:var(--text)}
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:14px;}
    @media (max-width: 860px){ .grid{grid-template-columns:1fr;} }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:16px;
    }
    .card h2{margin:0 0 12px 0; font-size:14px; color:rgba(232,238,246,.92)}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px;}
    .field{display:grid; gap:7px;}
    label{font-size:12px; color:var(--muted);}
    input{
      width:100%;
      padding:11px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.18);
      color:var(--text);
      font-size:15px;
      outline:none;
    }
    input:focus{
      border-color: rgba(110,168,254,.55);
      box-shadow:0 0 0 4px rgba(110,168,254,.12);
    }
    .note{margin-top:10px; color:var(--muted); font-size:12px; line-height:1.45;}
    .out{display:grid; gap:10px;}
    .kv{
      border:1px solid rgba(255,255,255,.10);
      border-radius:12px;
      background:rgba(0,0,0,.14);
      padding:12px;
      display:grid;
      grid-template-columns:1fr auto;
      gap:10px;
      align-items:center;
    }
    .k{color:var(--muted); font-size:12px;}
    .v{font-family:var(--mono); font-weight:800; font-size:15px;}
    .v.big{font-size:18px;}
    button{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:8px 10px;
      border-radius:10px;
      font-size:12px;
      font-weight:700;
    }
    button:hover{border-color:rgba(255,255,255,.22)}
    .warnbox{
      display:none;
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(251,191,36,.35);
      background:rgba(251,191,36,.10);
      color:rgba(255,255,255,.92);
      font-size:12px;
      line-height:1.45;
    }
    footer{color:var(--muted); font-size:12px; text-align:center; padding-top:4px;}
    code{font-family:var(--mono);}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Border Calculator</h1>
        <p class="sub">Enter image pixels. You’ll get the final canvas size and a warning if any extra adjustment is needed.</p>
      </div>
      <div class="pills">
        <div class="pill">Orientation: <b id="oriPill">—</b></div>
        <div class="pill">Default border: <b>3%</b></div>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <h2>Input</h2>

        <div class="row">
          <div class="field">
            <label for="w">Image width (px)</label>
            <input id="w" type="number" min="1" step="1" placeholder="e.g. 1080" />
          </div>
          <div class="field">
            <label for="h">Image height (px)</label>
            <input id="h" type="number" min="1" step="1" placeholder="e.g. 1620" />
          </div>
        </div>

        <div class="field" style="margin-top:12px">
          <label for="pct">Border percent</label>
          <input id="pct" type="number" min="0" step="0.1" value="3" />
        </div>

        <div class="note">
          Rules:
          <ul style="margin:8px 0 0 18px; padding:0;">
            <li><b>Portrait:</b> add % of <b>height</b> to W &amp; H, then ensure <b>4:5</b> (crop or expand border).</li>
            <li><b>Square:</b> add % of side to W &amp; H.</li>
            <li><b>Landscape:</b> add % of <b>width</b> to W &amp; H. If too wide for IG, fit into <b>3:2</b> border.</li>
          </ul>
        </div>

        <div class="warnbox" id="warn"></div>
      </section>

      <section class="card">
        <h2>Output</h2>

        <div class="out">
          <div class="kv">
            <div>
              <div class="k">Final recommended canvas (W × H)</div>
              <div class="v big" id="finalWH">—</div>
            </div>
            <button id="copyFinal" disabled>Copy</button>
          </div>

          <div class="kv">
            <div>
              <div class="k">Notes</div>
              <div class="v" id="notes">—</div>
            </div>
            <button id="copyNotes" disabled>Copy</button>
          </div>

          <div class="note">
            IG feed accepted aspect ratio range is roughly <b>1.91:1</b> to <b>4:5</b>. This tool warns if a landscape is outside that and suggests fitting into <b>3:2</b>.
          </div>
        </div>
      </section>
    </div>

    <footer>
      Descarte Collective image border calculator by Jon
    </footer>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const ceil = Math.ceil;

    function clampPosInt(x){
      if (!Number.isFinite(x)) return null;
      const n = Math.floor(x);
      return n >= 1 ? n : null;
    }

    function copy(btn, text) {
      return navigator.clipboard.writeText(text).then(() => {
        const old = btn.textContent;
        btn.textContent = "Copied!";
        setTimeout(() => (btn.textContent = old), 900);
      });
    }

    function setWarn(msg){
      const el = $("warn");
      if (!msg){ el.style.display="none"; el.textContent=""; return; }
      el.style.display="block";
      el.textContent = msg;
    }

    function orientationLabel(W,H){
      if (W === H) return "Square";
      if (H > W) return "Portrait";
      return "Landscape";
    }

    // Expand-only fit to a target ratio (rw:rh) such that final contains current W,H.
    function fitExpandOnlyToRatio(W, H, rw, rh){
      const Hcand = ceil(W * rh / rw); // keep width
      const Wcand = ceil(H * rw / rh); // keep height

      if (Hcand >= H) return { Wf: W, Hf: Hcand, mode: "Expanded height" };
      return { Wf: Wcand, Hf: H, mode: "Expanded width" };
    }

    function compute(W, H, pct){
      const ori = orientationLabel(W,H);
      const p = pct / 100;

      // Base border amount depends on orientation per your rules
      let B;
      if (ori === "Portrait") B = ceil(H * p);       // % of height
      else if (ori === "Square") B = ceil(W * p);    // % of side
      else B = ceil(W * p);                          // % of width (landscape)

      // After applying border (adds to both W and H)
      const baseW = W + B;
      const baseH = H + B;

      let finalW = baseW, finalH = baseH;
      let notes = "";

      if (ori === "Portrait") {
        // Ensure 4:5. If not, recommend expand-border fix (no shrinking).
        const is45 = (baseW * 5 === baseH * 4);
        if (is45) {
          notes = "Portrait is already 4:5 after the border. No extra adjustment needed.";
        } else {
          const fit = fitExpandOnlyToRatio(baseW, baseH, 4, 5);
          finalW = fit.Wf;
          finalH = fit.Hf;

          const extraW = finalW - baseW;
          const extraH = finalH - baseH;

          notes =
            `After border: ${baseW}×${baseH} (not 4:5). ` +
            `Expand to ${finalW}×${finalH} (${fit.mode}). ` +
            `Extra for 4:5: +${extraW}px W, +${extraH}px H.`;
          setWarn("Portrait needs 4:5. You must either crop to 4:5 or expand the border. This tool recommends the expand-border option.");
        }
      } else if (ori === "Landscape") {
        // Warn if likely outside IG feed ratio limits, suggest fitting to 3:2 by expanding only
        const ratio = baseW / baseH;
        if (ratio > 1.91) {
          const fit = fitExpandOnlyToRatio(baseW, baseH, 3, 2);
          finalW = fit.Wf;
          finalH = fit.Hf;
          const extraW = finalW - baseW;
          const extraH = finalH - baseH;

          notes =
            `Very wide for IG (ratio ~${ratio.toFixed(2)}). ` +
            `Suggested: fit into 3:2 → ${finalW}×${finalH}. ` +
            `Extra for 3:2: +${extraW}px W, +${extraH}px H.`;
          setWarn("Landscape looks too wide for the IG feed. Consider fitting it into a 3:2 border (expand only).");
        } else {
          notes = "Landscape is within common IG feed ratio limits. No special adjustment needed.";
          setWarn("");
        }
      } else {
        notes = "Square: no special adjustment needed.";
        setWarn("");
      }

      return { ori, finalW, finalH, baseW, baseH, notes };
    }

    function render(){
      const W = clampPosInt(Number($("w").value));
      const H = clampPosInt(Number($("h").value));
      const pct = Number($("pct").value);

      const valid = W && H && Number.isFinite(pct) && pct >= 0;

      $("copyFinal").disabled = !valid;
      $("copyNotes").disabled = !valid;

      if (!valid){
        $("oriPill").textContent = "—";
        $("finalWH").textContent = "—";
        $("notes").textContent = "—";
        setWarn("");
        return;
      }

      const ori = orientationLabel(W,H);
      $("oriPill").textContent = ori;

      const r = compute(W,H,pct);

      $("finalWH").textContent = `${r.finalW} × ${r.finalH}`;
      $("notes").textContent = r.notes;

      $("copyFinal").onclick = () => copy($("copyFinal"), `${r.finalW}x${r.finalH}`);
      $("copyNotes").onclick = () => copy($("copyNotes"), r.notes);
    }

    ["w","h","pct"].forEach(id => $(id).addEventListener("input", render));
    render();
  </script>
</body>
</html>
