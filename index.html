<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>4:5 Portrait Border Calculator</title>
  <style>
    :root{
      --bg:#0f1115;
      --card:#151822;
      --text:#e8eef6;
      --muted:#a7b0be;
      --line:rgba(255,255,255,.10);
      --accent:#6ea8fe;
      --radius:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:var(--bg);
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:24px;
    }
    .wrap{width:min(860px, 100%); display:grid; gap:14px;}
    header{
      display:flex; justify-content:space-between; align-items:flex-end; gap:12px; flex-wrap:wrap;
    }
    h1{margin:0; font-size:20px; letter-spacing:.2px;}
    .sub{margin:6px 0 0 0; color:var(--muted); font-size:13px; line-height:1.4;}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px; border:1px solid var(--line); border-radius:999px;
      color:var(--muted); font-size:12px;
    }
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:14px;}
    @media (max-width: 820px){ .grid{grid-template-columns:1fr;} }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:16px;
    }
    .card h2{
      margin:0 0 12px 0;
      font-size:14px;
      color:rgba(232,238,246,.92);
    }
    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px;}
    .field{display:grid; gap:7px;}
    label{font-size:12px; color:var(--muted);}
    input{
      width:100%;
      padding:11px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.18);
      color:var(--text);
      font-size:15px;
      outline:none;
    }
    input:focus{
      border-color: rgba(110,168,254,.55);
      box-shadow:0 0 0 4px rgba(110,168,254,.12);
    }
    .hint{margin-top:10px; color:var(--muted); font-size:12px; line-height:1.45;}
    .out{
      display:grid; gap:10px;
    }
    .kv{
      border:1px solid rgba(255,255,255,.10);
      border-radius:12px;
      background:rgba(0,0,0,.14);
      padding:12px;
      display:grid;
      grid-template-columns:1fr auto;
      gap:10px;
      align-items:center;
    }
    .k{color:var(--muted); font-size:12px;}
    .v{font-family:var(--mono); font-weight:800; font-size:15px;}
    .v.big{font-size:17px;}
    button{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:8px 10px;
      border-radius:10px;
      font-size:12px;
      font-weight:700;
    }
    button:hover{border-color:rgba(255,255,255,.22)}
    .warn{
      display:none;
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,193,7,.35);
      background:rgba(255,193,7,.10);
      color:rgba(255,255,255,.92);
      font-size:12px;
      line-height:1.45;
    }
    .btnrow{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
    .primary{
      border-color: rgba(110,168,254,.35);
      background: rgba(110,168,254,.12);
    }
    footer{color:var(--muted); font-size:12px; text-align:center; padding-top:4px;}
    code{font-family:var(--mono);}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>4:5 Portrait Border Calculator</h1>
        <p class="sub">
          No resizing. Canvas only expands (never shrinks). Output is always <b>4:5</b>.
        </p>
      </div>
      <div class="pill">Default border: <b>0.93%</b> of final height</div>
    </header>

    <div class="grid">
      <section class="card">
        <h2>Input</h2>

        <div class="row">
          <div class="field">
            <label for="w">Image width (px)</label>
            <input id="w" type="number" min="1" step="1" placeholder="e.g. 1080" />
          </div>
          <div class="field">
            <label for="h">Image height (px)</label>
            <input id="h" type="number" min="1" step="1" placeholder="e.g. 1620" />
          </div>
        </div>

        <div class="field" style="margin-top:12px;">
          <label for="p">Border percent (p)</label>
          <input id="p" type="number" min="0" step="0.01" value="0.93" />
        </div>

        <div class="btnrow">
          <button class="primary" id="ex1">Example 3648×5472</button>
          <button class="primary" id="ex2">Example 1080×1620</button>
          <button id="reset">Reset</button>
        </div>

        <div class="warn" id="warn"></div>

        <div class="hint">
          Method (portrait 4:5):
          <ol style="margin:8px 0 0 18px; padding:0;">
            <li>Enforce 4:5 by expanding canvas only (no shrinking).</li>
            <li>Compute extra border <code>B = ceil(H_ratio × p/100)</code>.</li>
            <li>Add <code>B</code> to height and keep ratio locked (width grows accordingly).</li>
            <li>Center the image in the final canvas.</li>
          </ol>
        </div>
      </section>

      <section class="card">
        <h2>Output</h2>

        <div class="out">
          <div class="kv">
            <div>
              <div class="k">Final canvas (W × H)</div>
              <div class="v big" id="finalWH">—</div>
            </div>
            <button id="copyFinal" disabled>Copy</button>
          </div>

          <div class="kv">
            <div>
              <div class="k">Borders (exact)</div>
              <div class="v" id="borders">—</div>
            </div>
            <button id="copyBorders" disabled>Copy</button>
          </div>

          <div class="kv">
            <div>
              <div class="k">Intermediate (4:5 before % add)</div>
              <div class="v" id="ratioStep">—</div>
            </div>
            <button id="copyRatio" disabled>Copy</button>
          </div>

          <div class="kv">
            <div>
              <div class="k">Extra border B (pixels)</div>
              <div class="v" id="Bpx">—</div>
            </div>
            <button id="copyB" disabled>Copy</button>
          </div>

          <div class="hint">
            Tip: This is intended for <b>portrait images</b> (H &gt; W). If you enter a landscape image, it will still output a 4:5 canvas (with very large side borders).
          </div>
        </div>
      </section>
    </div>

    <footer>
      Host on GitHub Pages: commit this <code>index.html</code> to <code>main</code> and enable Pages for <code>/(root)</code>.
    </footer>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);

    function clampPosInt(x) {
      if (!Number.isFinite(x)) return null;
      const n = Math.floor(x);
      return n >= 1 ? n : null;
    }

    function copy(btn, text) {
      return navigator.clipboard.writeText(text).then(() => {
        const old = btn.textContent;
        btn.textContent = "Copied!";
        setTimeout(() => (btn.textContent = old), 900);
      });
    }

    /**
     * 4:5 portrait canvas with percentage-based extra border.
     * - No scaling
     * - Never shrinks; only expands
     * - Final ratio always 4:5
     */
    function calcPortrait45(W, H, p) {
      const rw = 4, rh = 5;

      // Enforce 4:5 without shrinking:
      // Required height for 4:5 at current width:
      const H_target = Math.ceil(W * rh / rw);

      // Height after ratio enforcement must be >= original height and >= target
      const H_ratio = Math.max(H, H_target);

      // Width that matches 4:5 at H_ratio (may expand width)
      const W_ratio = Math.ceil(H_ratio * rw / rh);

      // Percentage-based extra border (based on the ratio-enforced long edge)
      const B = Math.ceil(H_ratio * (p / 100));

      // Add B to long edge, keep ratio locked
      const H_final = H_ratio + B;
      const W_final = Math.ceil(H_final * rw / rh);

      // Exact borders vs original image (centered)
      const padW = W_final - W;
      const padH = H_final - H;

      return {
        W_ratio, H_ratio,
        B,
        W_final, H_final,
        left: Math.floor(padW / 2),
        right: Math.ceil(padW / 2),
        top: Math.floor(padH / 2),
        bottom: Math.ceil(padH / 2),
      };
    }

    function setWarn(msg) {
      const el = $("warn");
      if (!msg) {
        el.style.display = "none";
        el.textContent = "";
        return;
      }
      el.style.display = "block";
      el.textContent = msg;
    }

    function render() {
      const W = clampPosInt(Number($("w").value));
      const H = clampPosInt(Number($("h").value));
      const p = Number($("p").value);

      const valid = W && H && Number.isFinite(p) && p >= 0;

      const btns = [$("copyFinal"), $("copyBorders"), $("copyRatio"), $("copyB")];
      btns.forEach(b => b.disabled = !valid);

      if (!valid) {
        $("finalWH").textContent = "—";
        $("borders").textContent = "—";
        $("ratioStep").textContent = "—";
        $("Bpx").textContent = "—";
        setWarn("");
        return;
      }

      if (H <= W) {
        setWarn("This tool is meant for portraits (H > W). You entered a landscape or square image; output will still be 4:5, but borders may be huge.");
      } else {
        setWarn("");
      }

      const r = calcPortrait45(W, H, p);

      $("finalWH").textContent = `${r.W_final} × ${r.H_final}`;
      $("ratioStep").textContent = `${r.W_ratio} × ${r.H_ratio}`;
      $("Bpx").textContent = `${r.B}px`;
      $("borders").textContent = `L ${r.left}px / R ${r.right}px / T ${r.top}px / B ${r.bottom}px`;

      $("copyFinal").onclick = () => copy($("copyFinal"), `${r.W_final}x${r.H_final}`);
      $("copyRatio").onclick = () => copy($("copyRatio"), `${r.W_ratio}x${r.H_ratio}`);
      $("copyB").onclick = () => copy($("copyB"), `${r.B}`);
      $("copyBorders").onclick = () => copy($("copyBorders"), `L${r.left} R${r.right} T${r.top} B${r.bottom}`);
    }

    $("w").addEventListener("input", render);
    $("h").addEventListener("input", render);
    $("p").addEventListener("input", render);

    $("ex1").addEventListener("click", () => { $("w").value = 3648; $("h").value = 5472; render(); });
    $("ex2").addEventListener("click", () => { $("w").value = 1080; $("h").value = 1620; render(); });
    $("reset").addEventListener("click", () => { $("w").value = ""; $("h").value = ""; $("p").value = 0.93; render(); });

    render();
  </script>
</body>
</html>
